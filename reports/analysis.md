# Интерпритация результатов работы модели, анализ её качества,  ошибок. Формирование выводов. 
## Основные показатели
### 1. Метрики (тестовая выборка)
```
Accuracy  (Точность): 91.11%   Процент правильных ответов из всех сделанных предсказаний. Из 100 фотографий модель правильно определяет стиль на 91 фотографии.
Precision (Точность взвеш.): 91.32%  Процент доверия к модели. Модель редко ошибается, присваивая метку.
Recall    (Полнота взвеш.):  91.11%  Процент всех тестовых изображений, который модель нашла и распознала. Пропущена малая частью.
F1-score  (Гармоническая):   91.02%  Оценка устойчивости модели. Она не угадывает, а действительно понимает признаки стилей.
```
### 2. Отчет по классам:
Эта таблица показывает, как модель справляется с каждым конкретным архитектурным стилем.
```
               precision   recall  f1-score   support

  Готический      0.93      0.87      0.90        15     
  Ренессанс       0.88      1.00      0.94        15
  Романский       0.93      0.87      0.90        15
```
**Ренессанс:**

```Recall = 1.00 (100%)``` - Это лучший результат по поиску. Модель нашла абсолютно все замки эпохи Ренессанса в тестовой выборке, не пропустив ни одного.

```Precision = 0.88 (88%)``` - Однако точность ниже других. Это значит, что модель иногда называет Ренессансом другие стили (в данном случае, она пару раз ошиблась, приняв Готику или Романский стиль за Ренессанс).

**Готический и Романский:**

```Precision = 0.93 (93%)``` -  Очень высокая точность. Если модель пишет «Готика», то это почти наверняка Готика.

```Recall = 0.87 (87%)``` -  Полнота чуть ниже. Модель пропустила примерно 13% замков этих стилей (обычно путая их друг с другом из-за исторической схожести каменной кладки и форм).

### 3. Матрица ошибок (Что с чем путает модель):
```    
                 Pred_Готический  Pred_Ренессанс  Pred_Романский
True_Готический               13               1               1
True_Ренессанс                 0              15               0
True_Романский                 1               1              13
```
Модель показала высокую общую точность (91.11%), однако матрица ошибок выявляет структуру неправильных меток:

**Класс Ренессанс:**

Самый распознаваемый класс. Recall = 1.00 (100%).

Модель нашла все 15 изображений Ренессанса в тестовой выборке и ни разу не пропустила их, однако Precision = 0.88, что означает наличие ложных срабатываний.

**Классы Готический и Романский:**

Оба стиля имеют одинаковые показатели Recall (0.87) — модель пропустила по 2 изображения в каждом классе.

```
1 готический собор был принят за романский.
1 романский собор был принят за готический.
```

Это ожидаемая ошибка, так как стили исторически связаны (готика выросла из романского стиля), и переходные формы архитектуры могут иметь признаки обоих стилей (например, массивные стены, но уже появляющиеся стрельчатые арки).

**Ложные срабатывания на Ренессанс:**

Хотя сам Ренессанс модель находит идеально, она иногда видит его там, где его нет. У модели есть небольшая склонность в пользу класса Ренессанс. Возможно, некоторые светлые или симметричные фото готических/романских зданий были ошибочно классифицированы как Ренессанс.

## Анализ типовых ошибок (на основе CSV и логов)

На предыдущих этапах анализа качества модели была выявлена проблема излишней самоуверенности модели. В ошибочных предсказаниях модель демонстрирует очень высокую уверенность (99-100%).

**Примеры ошибок:**

## 1.
  
```Файл 24364.jpg (Истина: Романский -> Предсказание: Ренессанс, Уверенность: 100%)```

<img width="224" height="224" alt="image" src="https://github.com/user-attachments/assets/ac25dbea-72a9-45a5-94c2-9a7704bd6d3a" />

**Вероятная причина ошибки:** Здание представляет собой идеальный прямоугольный параллелепипед. Фасад абсолютно симметричен, что является ключевой чертой архитектуры Ренессанса. Романский стиль обычно более асимметричен, с башнями разной высоты и пристройками. Окна расположены строгими рядами, создавая четкий горизонтальный ритм, характерный для Ренессанса. Стены гладкие у здания, светлые, с декоративными плоскими арками. Модель, вероятно, спутала эти высокие вертикальные арки с пилястрами или колоннами, типичными для ренессансного декора.
Также у здания отсутствуют явные оборонительные черты, свойственные Романскому стилю.

## 2.

```Файл 01.jpg (Истина: Романский -> Предсказание: Готический, Уверенность: 99.67%)```

<img width="224" height="224" alt="image" src="https://github.com/user-attachments/assets/db8fa797-a39b-42ab-b5a6-acedb7fb4f93" />

**Вероятная причина ошибки:** У силуэта замка очень много высоких, остроконечных башен. Острый пик крыши — это один из главных признаков готики. В классическом Романском стиле башни обычно более приземистые, с более пологими или плоскими крышами. При рассмотре изображение похоже на фэнтези-арт или стиль "неоготика/неоромантизм" XIX века. В таких постройках архитекторы специально усиливали декоративность и "готичность" силуэта для красоты, поэтому модель не смогла распознать Романский стиль и, более того, была уверена, что это именно Готика.

## 3.

```Файл ea4aedc142468b9c055da76dfd5edd52.jpg (Истина: Готический -> Предсказание: Романский, Уверенность: 97.93%)```

<img width="224" height="224" alt="image" src="https://github.com/user-attachments/assets/7b37b433-6c02-4733-8331-a9079126d40e" />

**Вероятная причина ошибки:** Оборонительный характер этой фотографии может сбивать модель. Здесь военная архитектура: узкие окна-бойницы, зубчатые стены и отсутствие декора. Модель видит крепость и относит её к Романскому периоду. Основные видимые элементы (башни, бойницы) имеют прямоугольную или скругленную форму. Серый, грубо отесанный камень характерен для Романского стиля. Готика (особенно поздняя) часто ассоциируется с более тонкой обработкой камня. 

## 4.

```Файл Ely_cathedral_(12859681464).jpg (Истина: Готический -> Предсказание: Ренессанс, Уверенность: 97.56%)```

<img width="224" height="224" alt="image" src="https://github.com/user-attachments/assets/0dfd9d5d-5613-44b3-af01-53f72279cb3e" />

**Вероятная причина ошибки:** Центральная башня собора не имеет классического острого шпиля, характерного для Готики. Вместо этого она представляет собой широкий восьмиугольный фонарь, увенчанный сложной деревянной конструкцией. Эта форма визуально очень близка к куполу — главному маркеру архитектуры Ренессанса. Здание на фото выглядит очень массивным, широким и приземистым. Ренессанс также тяготеет к горизонтали и устойчивости, тогда как классическая Готика — это обычно узкие, устремленные в небо стрелы. Фасад перенасыщен сложным декором, множество мелких арок и ниш создают регулярный геометрический узор. Модель могла интерпретировать эту регулярность и сложность как ордерную систему или декоративные фасады Ренессанса, а не как готическую структуру.

## Интерпретация работы модели и рекомендации

Лучше всего распознается Ренессанс. Модель идеально выучила признаки этого стиля (вероятно, симметрию, ордерную систему, купола). Романский и Готический стили распознаются хуже и чаще всего путаются между собой. Это объясняется их визуальным сходством (каменная кладка, церковная архитектура) и наличием переходных исторических периодов.

**Основные причины ошибок:**
- Малый размер выборки: Обучение на 201 изображении (по ~65-70 на класс) недостаточно для того, чтобы модель выучила все вариации стилей. 
- Визуальная схожесть классов: Готика и Романский стиль архитектурно ближе друг к другу, чем к Ренессансу, что подтверждается перекрестными ошибками в матрице.

**Рекомендации по улучшению модели:**

Для повышения Accuracy с 91% до 95-98% можно расширить датасет, добавить больше изображений для Романского и Готического стилей. Нужно найти и добавить в обучающую выборку сложные примеры: готика без высоких шпилей, романский стиль с элементами декора. При обучении можно использовать случайную обрезку, чтобы модель училась определять стиль не по общему силуэту замка, а по деталям (форма окон, аркбутаны, колонны).

## Вывод

Проведенный анализ работы ML-модели AutoGluon для классификации архитектурных стилей показал следующие результаты:

**1. Высокая эффективность базовой модели**

Модель достигла точности 91.11% на тестовой выборке, что является отличным показателем для небольшого датасета (201 изображение). Метрика F1-score (91.02%) подтверждает, что модель работает стабильно и сбалансировано, не имея критических перекосов в сторону одного класса. Стиль «Ренессанс» определяется наиболее надежно (100% обнаружение), выступая самым сильным классом модели.

**2. Основная зона ошибок: Готика / Романский стиль**

Главной проблемой для классификатора стало различение двух средневековых стилей — Готического и Романского. Ошибки возникают не хаотично, а систематически в смежных зонах: 

```
Модель склонна классифицировать любые массивные оборонительные сооружения (крепости) как Романский стиль, даже если они имеют готические элементы.
Здания с выраженной вертикалью и остроконечными крышами автоматически относятся к Готике, даже если это стилизация или неоготика.
```

**3. Проблема уникальных зданий**

Анализ ошибочных предсказаний с высокой уверенностью (99-100%) показал, что модель часто опирается на геометрические примитивы:

```
Симметрия и ритм окон →→ Ренессанс
Острые шпили →→ Готика
Грубый камень и стены →→ Романский стиль
```

Когда реальное историческое здание нарушает эти правила (например, симметричный романский дворец или готический собор с широкой башней), модель совершает уверенную ошибку.

**4. Перспективы развития**

Текущая версия модели подходит для демонстрации и использования в боте. Для выхода на уровень точности 95%+ необходимо целенаправленно добавить в обучающую выборку сложные примеры, нарушающие стереотипы (готические крепости, романские базилики с декором, асимметричный ренессанс), а также использовать аугментацию (RandomCrop) для обучения модели вниманию к деталям, а не только к общему силуэту.
